---
binaries:
  sh:
    title: Title of sh
    description: Description of sh
    motivation: Motivation of sh
    homepage: https://website.com/sh
    shell:
      run: sh
      diagnosis: sh --version

model:
  github:
    account: flarebyte
    name: object-crumble
  copyright:
    holder: Flarebyte.com Ltd
    startYear: 2021
  license: MIT
workflows:
  test:
    title: Test the library
    description: Test the library for defects
    tasks:
      jest:
        title: Run unit tests using Jest
        description: Use the Jest framework to run unit test (deprecated)
        parameters:
          fix:
            description: Fix the snapshots
            flags: '--fix'
        steps:
          - a: batch
            name: Test
            title: Run the jest unit tests
            commands:
              - name: test
                title: Test all test files in test folder
                run: npx baldrick-dev-ts test check
  compile:
    title: Compile source code
    description: Compile typescript source code
    tasks:
      build:
        title: Generate javascript
        description: Generate javascript from the typescript source code
        parameters:
          fix:
            description: The output directory
            flags: '--outDir'
        steps:
          - a: batch
            name: compile
            title: Compile the typescript code
            commands:
              - name: clean
                title: Delete dist folder
                run: rm -rf dist
              - name: tsc
                title: Compile with typescript
                run: tsc --outDir dist
      doc:
        title: Generate documentation
        description: Generate the documentation based on the source code
        parameters:
          fix:
            description: The output directory
            flags: '--outDir'
        steps:
          - a: batch
            name: main
            title: Generate the documentation
            commands:
              - name: report-folder
                title: Ensure that we have a report folder
                run: mdir -p report
              - name: typedoc
                title: Generate typedoc doc.json
                run: npx typedoc --json report/doc.json --pretty src/index.ts
              - name: api
                title: Generate markdown files for the Api
                run: npx baldrick-doc-ts typedoc --json-source report/doc.json
              - name: ngram
                title: Generate some markdown files with ngram
                run: baldrick-doc-ts parse -f internal ngram
              - name: fix
                title: Fix all the markdown files
                run: baldrick markdown fix
              - name: github
                run: baldrick markdown fix -s .github/
  github:
    title: Generate documentation
    description: Generate the documentation based on the source code
    tasks:
      standard:
        title: Standard
        description: Standard
        parameters:
          fix:
            description: aaa
            flags: '--fix'
        steps:
          - a: batch
            name: edit
            commands:
              - name: edit
                run: gh repo edit --delete-branch-on-merge --enable-squash-merge
  lint:
    title: Static code analysis
    description: Find problems in Typescript code
    tasks:
      check:
        title: Static code analysis of Typescript code
        description: Static code analysis of Typescript code
        parameters: {}
        steps:
          - a: batch
            name: main
            title: lint check
            commands:
              - name: check
                title: Lint check sources
                run: baldrick lint check -s src test
      fix:
        title: Static code analysis of Typescript code
        description: Static code analysis of Typescript code
        parameters: {}
        steps:
          - a: batch
            name: main
            commands:
              - name: fix
                run: baldrick lint fix -s src test
  md:
    title: Markdown documentation
    description: Manage markdown documentation
    tasks:
      check:
        title: Checks markdown documentation
        parameters: {}
        steps:
          - a: batch
            name: main
            commands:
              - name: check
                title: Check markdown files
                run: baldrick markdown check
              - name: github
                title: Check markdown files in github
                run: baldrick markdown check -s .github/
      fix:
        title: Fixes markdown documentation
        parameters: {}
        steps:
          - a: batch
            name: main
            commands:
              - name: fix
                title: Fix markdown files
                run: baldrick markdown fix
              - name: github
                title: Fix markdown files in github
                run: baldrick markdown fix -s .github/
  release:
    title: Prepare for release
    tasks:
      ready:
        title: Check that the library is ready to be published
        parameters: {}
        steps:
          - a: batch
            name: main
            commands:
              - name: lint
                run: baldrick lint check -s src test
              - name: markdown
                title: Check markdown files
                run: baldrick markdown check
              - name: markdown-github
                title: Check markdown files in github
                run: baldrick markdown check -s .github/
              - name: outdated
                title: Check whether some libraries are outdated
                run: yarn outdated
              - name: outdated
                title: Audit some libraries
                run: yarn audit
              - name: release-check
                title: Checks that the version has been incremented
                run: baldrick release check
  scaffold:
    title: Scaffolding for the project
    tasks:
      norm:
        title: Normalize the project
        parameters: {}
        steps:
          - a: batch
            name: main
            commands:
              - name: mkdir
                run: mkdir -p .vscode .github/workflows .github/ISSUE_TEMPLATE src test spec script script/data script/schema
              - name: snippet
                run: npx baldrick-whisker@latest object --no-ext .vscode/baldrick.code-snippets.json github:flarebyte:baldrick-reserve:data/ts/snippet.yaml
              - name: bug-report
                run: npx baldrick-whisker@latest object .github/ISSUE_TEMPLATE/bug_report.yaml github:flarebyte:baldrick-reserve:data/ts/bug-report.yaml
              - name: feature-request
                run: npx baldrick-whisker@latest object .github/ISSUE_TEMPLATE/feature_request.yaml github:flarebyte:baldrick-reserve:data/ts/feature-request.yaml
              - name: workflow-main
                run: npx baldrick-whisker@latest object .github/workflows/main.yml github:flarebyte:baldrick-reserve:data/ts/workflow-main.yml
              - name: gitignore
                run: npx baldrick-whisker@latest render --no-ext baldrick-broth.yaml github:flarebyte:baldrick-reserve:template/ts/gitignore.hbs .gitignore.sh
              - name: editorconfig
                run: npx baldrick-whisker@latest render --no-ext baldrick-broth.yaml github:flarebyte:baldrick-reserve:template/editorconfig.hbs .editorconfig.sh
              - name: contributing
                run: npx baldrick-whisker@latest render baldrick-broth.yaml github:flarebyte:baldrick-reserve:template/ts/contributing.hbs CONTRIBUTING.md
              - name: pull-request-template
                run: npx baldrick-whisker@latest render baldrick-broth.yaml github:flarebyte:baldrick-reserve:template/ts/pull-request-template.hbs .github/pull_request_template.md
              - name: glossary
                run: npx baldrick-whisker@latest render github:flarebyte:baldrick-reserve:data/glossary.yaml github:flarebyte:baldrick-reserve:template/glossary.hbs GLOSSARY.md

